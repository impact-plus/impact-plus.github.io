<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Vue 3 Single File HTML</title>
  <script src="https://unpkg.com/vue@next"></script>
  <link href="https://unpkg.com/tailwindcss@2.2.16/dist/tailwind.min.css" rel="stylesheet">
</head>

<body>
  <div id="app">
    <logo-component></logo-component>
    <pre>{{ csv }}</pre>
  </div>

  <script>
    const { createApp, ref } = Vue

    async function loadCSV() {
      const response = await fetch('http://127.0.0.1:8080/test.csv')
      const csvData = await response.text()

      const rows = csvData.split('\n')

      const headers = rows[0].replace(/;/g, '').split(',')

      rows.shift()

      const parsedData = rows.map(row => {
        const values = row.replace(/;/g, '').split(',')
        return headers.reduce((obj, header, index) => {
          obj[header] = values[index]
          return obj
        }, {})
      })

      return parsedData
    }

    const LogoComponent = {
      template: `
        <div class="w-full bg-blue-500 p-8 mb-4 rounded-lg">
          <h1 class="text-4xl text-white">IMPACT+</h1>
        </div>
      `
    }

    const app = createApp({
      setup() {
        const csv = ref([])

        loadCSV().then(data => {
          csv.value = data
        })

        return {
          csv
        }
      }
    })

    app.component('logo-component', LogoComponent)

    app.mount('#app')
  </script>
</body>

</html>