<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Vue 3 Single File HTML</title>
  <script src="https://unpkg.com/vue@next"></script>
  <link href="https://unpkg.com/tailwindcss@2.2.16/dist/tailwind.min.css" rel="stylesheet">
</head>

<body class="text-white bg-black">
  <div id="app">
    <logo-component></logo-component>

    <specs-wrapper>
      <row-component v-for="spec in specs" :label="spec.label" :description="spec.description">
        {{ spec.value }}
      </row-component>
    </specs-wrapper>
  </div>

  <script>
    const { createApp, ref } = Vue

    async function loadTSV(path) {
      const spreadsheetId = '2PACX-1vRq2HxY-FYmQrcjCsB015FGey51cT3fMV28ED2qjnTzPAjerJitb3YqzzZsIVxzj1G26B1KvfEt5r6D'
      const url = `https://docs.google.com/spreadsheets/d/e/${spreadsheetId}/pub?output=tsv`
      const response = await fetch(url)
      const csvData = await response.text()

      const rows = csvData.split('\n')

      const headers = rows[0].split('\t').map(header => header.trim())

      rows.shift()

      const parsedData = rows.map(row => {
        const values = row.split('\t').map(value => value.trim())
        return headers.reduce((obj, header, index) => {
          obj[header] = values[index]
          return obj
        }, {})
      })

      return parsedData
    }

    const LogoComponent = {
      template: `
        <div class="w-full bg-blue-500 p-8 mb-4 rounded-lg">
          <h1 class="text-4xl text-white">IMPACT+</h1>
        </div>
      `
    }

    const RowComponent = {
      props: ['label', 'description'],
      template: `
        <div>
          <strong class="text-2xl text-blue-500 float-right uppercase">{{ label }}</strong>
        </div>
        <div class="border-l-4 pl-2">
          <p class="text-2xl font-thin"><slot></slot></p>
          <em class="text-gray-400">{{ description }}</em>
        </div>
      `
    }

    const SpecsWrapper = {
      template: `<div class="grid grid-cols-2 gap-4"><slot></slot></div>`
    }

    const app = createApp({
      setup() {
        const specs = ref([])

        loadTSV('specs').then(data => {
          specs.value = data
        })

        return {
          specs
        }
      }
    })

    app.component('logo-component', LogoComponent)
    app.component('row-component', RowComponent)
    app.component('specs-wrapper', SpecsWrapper)

    app.mount('#app')
  </script>
</body>

</html>